{% extends "admin/base_site.html" %}
{% load static %}

{% block content %}
<div class="max-w-6xl mx-auto p-6">
  <h1 class="text-2xl font-semibold mb-4">
    Quiz Results – {{ quiz.title }}
  </h1>

  <div class="mb-4">
    <a
      href="{% url 'quiz:quiz_edit' quiz.id %}"
      class="px-4 py-2 bg-gray-200 rounded hover:bg-gray-300"
    >
      ← Back to Quiz
    </a>
  </div>

  <div class="border rounded overflow-hidden">
    <table class="w-full border-collapse text-sm">
      <thead class="bg-gray-100">
        <tr>
          <th class="p-3 text-left">Team Code</th>
          <th class="p-3 text-left">Email</th>
          <th class="p-3 text-center">Attempt</th>
          <th class="p-3 text-center">Status</th>
          <th class="p-3 text-center">Warnings</th>
          <th class="p-3 text-center">Fullscreen</th>
          <th class="p-3 text-center">DevTools</th>
          <th class="p-3 text-center">Started</th>
          <th class="p-3 text-center">Ended</th>
        </tr>
      </thead>
      <tbody>
        {% for attempt in attempts %}
        <tr class="border-t">
          <td class="p-3 font-medium">
            {{ attempt.team_code }}
          </td>
          <td class="p-3">
            {{ attempt.team_lead_email }}
          </td>
          <td class="p-3 text-center">
            {{ attempt.attempt_number }}
          </td>
          <td class="p-3 text-center">
            {% if attempt.status == "submitted" %}
              <span class="text-green-600 font-semibold">Submitted</span>
            {% elif attempt.status == "auto_submitted" %}
              <span class="text-blue-600 font-semibold">Auto</span>
            {% elif attempt.status == "disqualified" %}
              <span class="text-red-600 font-semibold">Disqualified</span>
            {% else %}
              <span class="text-yellow-600 font-semibold">Active</span>
            {% endif %}
          </td>
          <td class="p-3 text-center">
            {{ attempt.warnings_used }}
          </td>
          <td class="p-3 text-center">
            {{ attempt.fullscreen_violations }}
          </td>
          <td class="p-3 text-center">
            {{ attempt.devtools_violations }}
          </td>
          <td class="p-3 text-center text-gray-600">
            {{ attempt.started_at|date:"H:i:s" }}
          </td>
          <td class="p-3 text-center text-gray-600">
            {{ attempt.ended_at|date:"H:i:s"|default:"—" }}
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="9" class="p-4 text-center text-gray-500">
            No attempts found.
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
